<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <title>编辑代理--详情</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <!-- <script>
      (function () {
        if (window !== window.top) {
          window.top.location.href = 'http://www.818tu.com';
        }
      })();
    </script> -->

    <!-- bootstrap & fontawesome -->








    <!-- page specific plugin styles -->
    <script src="__PUBLIC__/admin/js/jquery.min.js"></script>
    <script src="__PUBLIC__/admin/js/lodash.min.js"></script>
    <script src="__PUBLIC__/admin/js/moment.min.js"></script>
    <script src="__PUBLIC__/admin/js/zh-cn.js"></script>
    <script src="__PUBLIC__/admin/js/numeral.min.js"></script>
    <script src="__PUBLIC__/admin/js/toastr.min.js"></script>
    <script src="__PUBLIC__/admin/js/cookies.js"></script>
    <script src="__PUBLIC__/admin/js/knockout-min.js"></script>
    <script src="__PUBLIC__/admin/js/knockout.mapping.min.js"></script>
    <script src="__PUBLIC__/admin/js/bootstrap-datetimepicker.min.js"></script>
    <script src="__PUBLIC__/admin/js/jquery.validate.min.js"></script>
    <script src="__PUBLIC__/admin/js/jquery.validate.unobtrusive.min.js"></script>
    <script src="__PUBLIC__/admin/js/clipboard.min.js"></script>
    <script src="__PUBLIC__/admin/js/select2.min.js"></script>
    <script src="__PUBLIC__/admin/js/admin.js"></script>
    <script>
      moment.locale('zh-cn');
      toastr.options.positionClass = 'toast-bottom-right';
    </script>

    <!-- text fonts -->


    <!-- ace styles -->


    <!--[if lte IE 9]>
        <link rel="stylesheet" href="http://novel.818tu.com/static/assets/css/ace-part2.min.css" />
    <![endif]-->




    <!--[if lte IE 9]>
        <link rel="stylesheet" href="http://novel.818tu.com/static/css/ace-ie.min.css" />
    <![endif]-->



    <!-- inline styles related to this page -->

    <!-- ace settings handler -->
    <script src="__PUBLIC__/admin/js/ace-extra.min.js"></script>

    <!-- <script>
      var __BASEURL = "http://novel.818tu.com/";
    </script> -->

<link media="all" href="__PUBLIC__/admin/css/index15.css" type="text/css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/css/glyphicons-halflings-regular.css">
</head>
<body class="no-skin">

    <!-- #section:basics/navbar.layout -->
        <include file="./Public/gong/title.html" />

    <div class="main-container" id="main-container">
      <script type="text/javascript">
        try{ace.settings.check('main-container' , 'fixed')}catch(e){}
      </script>

      <div id="sidebar" class="sidebar responsive">
          <script type="text/javascript">
            try{ace.settings.check('sidebar' , 'fixed')}catch(e){}
          </script>

                     <include file="./Public/gong/list.html" />
          <div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
            <i class="ace-icon fa fa-angle-double-left" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
          </div>

          <script type="text/javascript">
            try{ace.settings.check('sidebar' , 'collapsed')}catch(e){}
          </script>
      </div>

      <!-- /section:basics/sidebar -->
      <div class="main-content">

                    <!-- <div id="invalid-mp-settings-hint" style="border-top: 0px none; border-left: 0px none; border-right: 0px none; margin: 0px;" class="alert alert-warning">
    <i class="fa fa-warning"></i> 您的公众号配置不完整，推广前请务必配置好公众号信息。<a href="http://novel.818tu.com/backend/settings/mp">立即配置</a>
</div> -->

<!-- <script>
    $.get('/backend/settings/api_check_mp_settings?t' + new Date().getTime(), function (result) {
        if (!result.valid) {
            $('#invalid-mp-settings-hint').slideDown();
        }
    });
</script> -->
        <div class="breadcrumbs" id="breadcrumbs">
          <script type="text/javascript">
            try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
          </script>

          <ul class="breadcrumb">
            <li>
              <i class="ace-icon fa fa-home home-icon"></i>
              <a href="#">Home</a>
            </li>
            <li class="active">编辑代理</li>
          </ul><!-- /.breadcrumb -->

          <!-- /section:basics/content.searchbox -->
        </div>

        <!-- /section:basics/content.breadcrumbs -->
        <div class="page-content">
          <div class="page-content-area">
            <div class="row">
              <div class="col-xs-12">
                <!-- PAGE CONTENT BEGINS -->

                <!--/span-->
                <!-- left menu ends -->



<form id="main-form" class="form-horizontal" novalidate="novalidate" action="__URL__/do_edit_admin" method="POST">
    <h4>基本信息</h4>
    <div class="form-group">
        <label class="col-sm-3 control-label no-padding-right">用户名</label>
        <div class="col-sm-9">
            <input name="username" class="col-xs-10 col-sm-5" maxlength="20" data-val="true" data-val-required="请输入用户名" data-bind="value: username, disable: is_edit" value="{$user.username}" type="text" readonly="readonly">
            <p class="help-block help-block-error" data-valmsg-for="username" data-valmsg-replace="true"></p>
        </div>
    </div>

    <div class="form-group" style="">
        <label class="col-sm-3 control-label no-padding-right" style="color:red;">新密码</label>
        <div class="col-sm-9">
            <input name="password" class="col-xs-10 col-sm-5" data-val="true"  data-bind="value: password" value="" type="text">
            <p class="help-block help-block-error" data-valmsg-for="password" data-valmsg-replace="true"></p>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-3 control-label no-padding-right">代理名称</label>
        <div class="col-sm-9">
            <input name="nickname" class="col-xs-10 col-sm-5" data-val="true" data-val-required="请输入昵称" data-bind="value: nickname" value="{$user.nickname}" type="text">
            <p class="help-block help-block-error" data-valmsg-for="nickname" data-valmsg-replace="true"></p>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-3 control-label no-padding-right">邮箱</label>
        <div class="col-sm-9">
            <input name="email" class="col-xs-10 col-sm-5" data-bind="value: email" value="{$user.email}" type="text">
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-3 control-label no-padding-right">手机</label>
        <div class="col-sm-9">
            <input name="tel" class="col-xs-10 col-sm-5" data-bind="value: mobile" value="{$user.tel}" type="text">
        </div>
    </div>

            <h4>抽成设置</h4>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">抽成比例</label>
            <div class="col-sm-9">
                <input name="pro" class="col-xs-10 col-sm-5" data-bind="value: commission_rate" data-val="true" data-val-required="请输入抽成比例" value="{$user.pro}" type="text">
                <p class="help-block col-xs-10" style="padding-left: 0px;">
                    填写 0 到 1 之间的数字。
                                            <span style="color: red;">
                            若用户充值 1000 元, 抽成比例为 0.7，则需要向该代理打款 1000 x 0.7 = 700 元
                        </span>
                                    </p>
                <p class="help-block help-block-error col-xs-10" style="padding-left: 0px;" data-valmsg-for="commission_rate" data-valmsg-replace="true"></p>
            </div>
        </div>


        <h4>收款信息</h4>

    <div class="form-group">
        <label class="col-sm-3 control-label no-padding-right">收款方式</label>
        <div class="col-sm-9">
            <if condition="$user['cardtype'] heq '银行卡'">
                <label class="radio-inline">
                    <input name="cardtype" value="银行卡" data-bind="checked: payment_account_type" checked="checked" type="radio" class="checktype"> 银行卡
                </label>
                <label class="radio-inline">
                    <input name="cardtype" value="支付宝" data-bind="checked: payment_account_type" type="radio" class="checktype"> 支付宝
                </label>
                <label class="radio-inline">
                    <input name="cardtype" value="微信" data-bind="checked: payment_account_type" type="radio" class="checktype"> 微信
                </label>
            <elseif condition="$user['cardtype'] heq '支付宝'"/>
                <label class="radio-inline">
                    <input name="cardtype" value="银行卡" data-bind="checked: payment_account_type" type="radio" class="checktype"> 银行卡
                </label>
                <label class="radio-inline">
                    <input name="cardtype" value="支付宝" data-bind="checked: payment_account_type" type="radio" class="checktype"  checked="checked"> 支付宝
                </label>
                <label class="radio-inline">
                    <input name="cardtype" value="微信" data-bind="checked: payment_account_type" type="radio" class="checktype"> 微信
                </label>
            <elseif condition="$user['cardtype'] heq '微信'"/>
                <label class="radio-inline">
                    <input name="cardtype" value="银行卡" data-bind="checked: payment_account_type" type="radio" class="checktype"> 银行卡
                </label>
                <label class="radio-inline">
                    <input name="cardtype" value="支付宝" data-bind="checked: payment_account_type" type="radio" class="checktype" > 支付宝
                </label>
                <label class="radio-inline">
                    <input name="cardtype" value="微信" data-bind="checked: payment_account_type" type="radio" class="checktype" checked="checked"> 微信
                </label>
            </if>
        </div>
    </div>
<if condition="$user['cardtype'] heq '银行卡'">
    <div data-bind="visible: payment_account_type() === 'bank'" style="display:block;" id="show1">
        <!-- <div class="form-group">
            <div class="col-sm-9 col-sm-offset-3">
                <label class="checkbox-inline">
                    <input name="is_company" data-bind="checked: is_company" type="checkbox">
                    <span>对公帐户</span>
                </label>
            </div>
        </div> -->
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right" data-bind="text: is_company() ? '公司名称' : '持卡人姓名'">持卡人姓名</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: card_holder_name" value="{$user.carduser}" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">银行卡号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: card_number" value="{$user.cardnumber}" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">开户行</label>
            <div class="col-sm-9">
                <input name="cardbank[]" class="col-xs-10 col-sm-5" data-bind="value: card_bank_branch" value="{$user.cardbank}" type="text">
            </div>
        </div>
    </div>
    <div data-bind="visible: payment_account_type() === 'alipay'" style="display: none;" id="show2">
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">帐号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: alipay_account_number" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">姓名</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: alipay_account_name" value="" type="text">
            </div>
        </div>
    </div>
    <div data-bind="visible: payment_account_type() === 'weixin'" style="display: none;" id="show3">
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">微信号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: weixin_account" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">昵称</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: weixin_nickname" value="" type="text">
            </div>
        </div>
    </div>
<elseif condition="$user['cardtype'] heq '支付宝'"/>
    <div data-bind="visible: payment_account_type() === 'bank'" style="display:none;" id="show1">
        <!-- <div class="form-group">
            <div class="col-sm-9 col-sm-offset-3">
                <label class="checkbox-inline">
                    <input name="is_company" data-bind="checked: is_company" type="checkbox">
                    <span>对公帐户</span>
                </label>
            </div>
        </div> -->
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right" data-bind="text: is_company() ? '公司名称' : '持卡人姓名'">持卡人姓名</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: card_holder_name" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">银行卡号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: card_number" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">开户行</label>
            <div class="col-sm-9">
                <input name="cardbank[]" class="col-xs-10 col-sm-5" data-bind="value: card_bank_branch" value="" type="text">
            </div>
        </div>
    </div>
    <div data-bind="visible: payment_account_type() === 'alipay'" style="display: block;" id="show2">
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">帐号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: alipay_account_number" value="{$user.cardnumber}" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">姓名</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: alipay_account_name" value="{$user.carduser}" type="text">
            </div>
        </div>
    </div>
    <div data-bind="visible: payment_account_type() === 'weixin'" style="display: none;" id="show3">
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">微信号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: weixin_account" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">昵称</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: weixin_nickname" value="" type="text">
            </div>
        </div>
    </div>
<elseif condition="$user['cardtype'] heq '微信'"/>
    <div data-bind="visible: payment_account_type() === 'bank'" style="display:none;" id="show1">
        <!-- <div class="form-group">
            <div class="col-sm-9 col-sm-offset-3">
                <label class="checkbox-inline">
                    <input name="is_company" data-bind="checked: is_company" type="checkbox">
                    <span>对公帐户</span>
                </label>
            </div>
        </div> -->
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right" data-bind="text: is_company() ? '公司名称' : '持卡人姓名'">持卡人姓名</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: card_holder_name" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">银行卡号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: card_number" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">开户行</label>
            <div class="col-sm-9">
                <input name="cardbank[]" class="col-xs-10 col-sm-5" data-bind="value: card_bank_branch" value="" type="text">
            </div>
        </div>
    </div>
    <div data-bind="visible: payment_account_type() === 'alipay'" style="display: none;" id="show2">
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">帐号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: alipay_account_number" value="" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">姓名</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: alipay_account_name" value="" type="text">
            </div>
        </div>
    </div>
    <div data-bind="visible: payment_account_type() === 'weixin'" style="display: block;" id="show3">
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">微信号</label>
            <div class="col-sm-9">
                <input name="cardnumber[]" class="col-xs-10 col-sm-5" data-bind="value: weixin_account" value="{$user.cardnumber}" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">昵称</label>
            <div class="col-sm-9">
                <input name="carduser[]" class="col-xs-10 col-sm-5" data-bind="value: weixin_nickname" value="{$user.carduser}" type="text">
            </div>
        </div>
    </div>
</if>
    <!-- <div class="form-group">
        <div class="col-sm-9 col-sm-offset-3">
            <label class="checkbox-inline">
                <input name="auto_withdraw" data-bind="checked: auto_withdraw" type="checkbox"> 结算单自动发起提现
            </label>
        </div>
    </div> -->


            <h4>等级划分</h4>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">等级</label>
            <div class="col-sm-9">
                <select name="eva" data-bind="value: affiliate_level" class="col-xs-10 col-sm-5">
                    <option value="{$user.eva}">当前等级:{$user.eva}</option>
                    <option value="待定">待定</option>
                    <option value="差">差</option>
                    <option value="良">良</option>
                    <option value="优">优</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label no-padding-right">备注</label>
            <div class="col-sm-9">
                <textarea name="remark" data-bind="value: remark" maxlength="255" class="col-xs-10 col-sm-5" style="padding-left: 5px;resize:none;" value="{$user.remark}">{$user.remark}</textarea>
            </div>
        </div>

    <div class="clearfix form-actions">
        <div class="col-md-offset-3 col-md-9">
            <input type="hidden" name="id" value="{$user.id}">
            <button type="submit" class="btn btn-info" data-bind="click: submit, disable: submitting">提交</button>
        </div>
    </div>
</form>

<!-- <script>
    var userId = null;
    var isEdit = parseInt(userId) > 0;

    var viewModel = {
        id: ko.observable(userId),
        is_edit: ko.observable(isEdit),
        submitting: ko.observable(false),
        username: ko.observable(),
        password: ko.observable(),
        nickname: ko.observable(),
        email: ko.observable(),
        mobile: ko.observable(),
        commission_rate: ko.observable(),
        enable_vip_products: ko.observable(false),
        enable_template_message: ko.observable(false),
        affiliate_level: ko.observable(),
        remark: ko.observable(),

        inviter_uid: ko.observable(),
        inviter_reward_rate: ko.observable(),

        payment_account_type: ko.observable('bank'),

        card_holder_name: ko.observable(),
        card_number: ko.observable(),
        card_bank_branch: ko.observable(),
        is_company: ko.observable(false),

        alipay_account_number: ko.observable(),
        alipay_account_name: ko.observable(),

        weixin_account: ko.observable(),
        weixin_nickname: ko.observable(),

        auto_withdraw: ko.observable(0),

        is_internal_channel: ko.observable(0)
    };

    viewModel.submit = function () {
        if (viewModel.submitting()) {
            return false;
        }

        if (!$('#main-form').valid()) {
            return false;
        }

        viewModel.submitting(true);

        $.ajax({
            url: '/backend/users/api_save',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(ko.mapping.toJS(viewModel))
        })
            .then(function (data) {
                location.href = '/backend/users/affiliates';
            })
            .fail(handleAjaxError)
            .always(function () {
                viewModel.submitting(false);
            });
    };

    $(function () {
        if (userId) {
            $.get('/backend/users/api_get/' + userId, function (data) {
                ko.mapping.fromJS(data, {}, viewModel);
                ko.applyBindings(viewModel, document.getElementById('main-form'));
            });
        } else {
            viewModel.password('JhFWfE9q');
            ko.applyBindings(viewModel, document.getElementById('main-form'));
        }
    });
</script> -->

                                <!-- PAGE CONTENT ENDS -->
                            </div><!-- /.col -->
                        </div><!-- /.row -->
                    </div><!-- /.page-content-area -->
                </div><!-- /.page-content -->
            </div><!-- /.main-content -->

        </div><!-- /.main-container -->

        <!-- basic scripts -->

      <!--   <script type="text/javascript">
            if('ontouchstart' in document.documentElement) document.write("<script src='http://novel.818tu.com/static/assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
        </script> -->
        <script src="__PUBLIC__/admin/js/bootstrap.min.js"></script>
        <script src="__PUBLIC__/admin/js/jquery.webui-popover.min.js"></script>
        <script src="__PUBLIC__/admin/js/jquery.ui.widget.min.js"></script>
        <script src="__PUBLIC__/admin/js/jquery.fileupload.min.js"></script>

        <!-- page specific plugin scripts -->

        <!-- ace scripts -->
        <script src="__PUBLIC__/admin/js/ace-elements.min.js"></script>
        <script src="__PUBLIC__/admin/js/ace.min.js"></script>

        <!-- inline scripts related to this page -->

        <!-- the following scripts are used in demo only for onpage help and you don't need them -->


        <!-- <script type="text/javascript"> ace.vars['base'] = 'http://novel.818tu.com/static'; </script> -->
        <script src="__PUBLIC__/admin/js/elements.onpage-help.js"></script>
        <script src="__PUBLIC__/admin/js/ace.onpage-help.js"></script>
<script type="text/javascript">
$('.checktype').click(function(event) {
    var type = $(this).val();
    if(type == '银行卡')
    {
        $('#show1').css('display','block');
        $('#show2').css('display','none');
        $('#show3').css('display','none');
    }else if(type == '支付宝')
    {
        $('#show1').css('display','none');
        $('#show2').css('display','block');
        $('#show3').css('display','none');
    }else if(type == '微信')
    {
        $('#show1').css('display','none');
        $('#show2').css('display','none');
        $('#show3').css('display','block');
    }
});
</script>

</body>
</html>
